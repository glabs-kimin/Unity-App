<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>경기도 Unity MVP (v1.7)</title>
    <style>
        /* CSS는 이전 v1.6 버전과 동일합니다. */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
        :root { --primary-blue: #0A2C4A; --accent-warm: #FFB836; --text-dark: #333333; --text-light: #777777; --bg-light: #f8f9fa; --white: #ffffff; --border-color: #e9ecef; }
        body { font-family: 'Noto Sans KR', sans-serif; margin: 0; background-color: #ccc; display: flex; justify-content: center; padding: 20px 0; }
        .phone-container { width: 375px; height: 812px; background-color: var(--white); box-shadow: 0 0 20px rgba(0,0,0,0.1); border-radius: 40px; overflow: hidden; border: 10px solid #111; display: flex; flex-direction: column; }
        .content-scroll { flex-grow: 1; overflow-y: auto; background-color: var(--bg-light); }
        .screen { padding: 20px; }
        .main-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .main-header .logo { font-size: 20px; font-weight: 700; color: var(--primary-blue); }
        .bottom-nav { display: flex; justify-content: space-around; background-color: var(--white); border-top: 1px solid var(--border-color); padding: 10px 0; width: 100%; }
        .nav-btn { text-align: center; font-size: 12px; color: var(--text-light); cursor: pointer; flex-grow: 1; }
        .nav-btn.active { color: var(--accent-warm); font-weight: 700; }
        .menu-list-item { background-color: var(--white); padding: 15px; border-bottom: 1px solid var(--border-color); cursor: pointer; }
        .menu-list-item:hover { background-color: #f8f9fa; }
        .menu-list-item.disabled { color: #aaa; cursor: not-allowed; }
    </style>
</head>
<body>
    <div class="phone-container">
        <div class="content-scroll">
            <div id="auth-screen" class="screen"> </div>
            <div id="main-screen" class="screen" style="display:none;"> </div>
            <div id="program-list-screen" class="screen" style="display:none;"> </div>
            <div id="my-bookings-screen" class="screen" style="display:none;"> </div>

            <div id="my-page-screen" class="screen" style="display:none;">
                <header class="main-header">
                    <div class="logo">마이페이지</div>
                </header>
                <main>
                    <div class="program-card" style="margin-bottom: 20px;">
                        <h3 id="mypage-user-email">user@example.com</h3>
                        <p>일반 회원</p>
                    </div>
                    <div class="menu-list">
                        <div class="menu-list-item disabled">회원 정보 수정 (준비 중)</div>
                        <div class="menu-list-item disabled">결제 카드 관리 (준비 중)</div>
                        <div class="menu-list-item">고객센터 / 문의하기</div>
                        <div class="menu-list-item" id="mypage-logout-button">로그아웃</div>
                    </div>
                </main>
            </div>
            
            <div id="pass-screen" class="screen" style="display:none; text-align: center;"> </div>
        </div>
        <footer class="bottom-nav" style="display:none;">
            <div class="nav-btn" id="nav-home">홈</div>
            <div class="nav-btn" id="nav-programs">전체 프로그램</div>
            <div class="nav-btn" id="nav-my-bookings">내 예약</div>
            <div class="nav-btn" id="nav-my-page">마이페이지</div>
        </footer>
    </div>

    <script>
      // ... (이전 버전의 모든 코드와 로직을 포함) ...

      // --- HTML 요소 추가 ---
      const myPageScreen = document.getElementById('my-page-screen');
      const navMyPageBtn = document.getElementById('nav-my-page');
      const mypageUserEmail = document.getElementById('mypage-user-email');
      const mypageLogoutButton = document.getElementById('mypage-logout-button');

      // --- 함수 수정 ---
      
      // 화면 전환 함수에 '마이페이지' 추가
      function showScreen(screenKey) {
        Object.values(screens).forEach(screen => screen.style.display = 'none');
        screens[screenKey].style.display = 'block';

        Object.values(navButtons).forEach(btn => btn.classList.remove('active'));
        if (navButtons[screenKey]) {
            navButtons[screenKey].classList.add('active');
        } else { /* ... */ }
      }

      // --- 이벤트 리스너 및 상태 관리 수정 ---

      auth.onAuthStateChanged(user => {
        if (user) {
          // ... (이전 로그인 로직) ...
          mypageUserEmail.textContent = user.email; // 마이페이지에 이메일 표시
        } else {
          showScreen('auth');
          bottomNav.style.display = 'none';
        }
      });
      
      // '마이페이지' 버튼 클릭 이벤트 추가
      navMyPageBtn.addEventListener('click', () => showScreen('myPage'));
      
      // 마이페이지 내 로그아웃 버튼 이벤트
      mypageLogoutButton.addEventListener('click', () => auth.signOut());

    </script>
</body>
</html>